---
title: "P8105 - Homework 2"
author: "Jake W. Coldiron - jwc2177 -"
date: "4 October 2023"
output: github_document
---

Before we begin, let's initialize a few helpful libraries since we're working with .csv files and .xlsx files.


```{r Initialize Libraries, collapse = TRUE}
#Initialize Libraries

library(tidyverse)

library(readxl)

library(writexl)
```

# I. Problem 1

This problem uses the FiveThirtyEight data; these data were gathered to create the interactive graphic on this page. In particular, we’ll use the data in pols-month.csv, unemployment.csv, and snp.csv. Our goal is to merge these into a single data frame using year and month as keys across datasets.

## i. pols-month.csv

First, clean the data in pols-month.csv:

1. Use separate() to break up the variable mon into integer variables year, month, and day;
1. replace month number with month name; 
1. create a president variable taking values gop and dem, and remove prez_dem and prez_gop; 
1. and remove the day variable.

```{r pols_month piped and cleaned}
#pols_month piped and cleaned

pols_df = read_csv("./p8105_hw2_jwc2177_data/fivethirtyeight_datasets/pols-month.csv") %>% 
  
  separate(mon, into = c("year", "month"), sep = 4) %>% 
  
  separate(month, into = c("month", "day"), sep = 4) %>% 
  
   mutate(year = as.numeric(year)) %>% 
  
  mutate(month = recode(month, "-01-" = "january", "-02-" = "february", "-03-" = "march", "-04-" = "april", "-05-" = "may", "-06-" = "june", "-07-" = "july", "-08-" = "august", "-09-" = "september", "-10-" = "october", "-11-" = "november", "-12-" = "december")) %>% 
  
  pivot_longer(
    c("prez_gop", "prez_dem"),
    names_to = "prez",
    values_to = "whitehouse"
    ) %>% 
  
  mutate(prez = recode(prez, "prez_gop" = "gop", "prez_dem" = "dem")) %>% 
  
#Apparently there was a value of 2 for the President in September 1974, October 1974, November 1974, and December 1974. This does not make sense as the US only has one President at a time. 
  
#The value is likely referring to the resignation of Richard Nixon. Immediately after Nixon resigned on 9 August 1974, his  Vice President Gerald Ford was sworn in as President. If there was going to be a value of 2 for the President, then August 1974 would make the most sense, however there is no value of 2 in August 1974 only the aforementioned months. 
  
#This doesn't make much sense. Regardless, the data was processed as given.
  
  mutate(whitehouse = recode(whitehouse, "0" = "no", "1" = "yes", "2" = "yes")) %>% 
  
  select(-day) %>% 
  
  relocate(year, month, prez, whitehouse, gov_dem, gov_gop, rep_dem, rep_gop, sen_dem, sen_gop)

pols_df
```

## ii. snp.csv

Second, clean the data in snp.csv using a similar process to the above. For consistency across datasets:

1. arrange according to year and month, 
1. and organize so that year and month are the leading columns.

```{r snp piped and cleaned}
#snp piped and cleaned

snp_df = read_csv("./p8105_hw2_jwc2177_data/fivethirtyeight_datasets/snp.csv") %>%
  separate(date, into = c("month", "day", "year")) %>% 
  
  mutate(month = recode(month, "1" = "january", "2" = "february","3" = "march","4" = "april","5" = "may","6" = "june","7" = "july","8" = "august","9" = "september","10" = "october","11" = "november","12" = "december")) %>% 
  
  mutate(year = paste("20", year, sep = "")) %>% 
  
  mutate(year = as.numeric(year)) %>% 
  
  mutate(year = ifelse(year > 2015, year - 100, year)) %>% 
  
  select(-day) %>% 
  
  relocate(year, month, close) %>% 
  
  rename(snp_close = close)

snp_df
```


## iii. unemployment.csv

Third, tidy the unemployment data so that it can be merged with the previous datasets. This process will involve switching from “wide” to “long” format; ensuring that key variables have the same name; and ensuring that key variables take the same values.

```{r unemployment piped and cleaned}
#unemployment piped and cleaned

unemployment_df = read_csv("./p8105_hw2_jwc2177_data/fivethirtyeight_datasets/unemployment.csv") %>%
  
  janitor::clean_names() %>% 
  
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment_percent"
  ) %>% 
  
  mutate(month = recode(month, "jan" = "january", "feb" = "february", "mar" = "march", "apr" = "april", "may" = "may", "jun" = "june", "jul" = "july", "aug" = "august", "sep" = "september", "oct" = "october", "nov" = "november", "dec" = "december"))
  

unemployment_df

```

## iv. Joining the Datasets 

Fourth, join the datasets by merging snp into pols, and merging unemployment into the result.

```{r, joining the table together}
#joining the table together

snp_into_pol =
  left_join(pols_df, snp_df)

five_thirty_eight = 
  left_join(snp_into_pol, unemployment_df)

five_thirty_eight
```


## v. Describing the Joined Dataset 

Fifth, write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

<br>

# II. Problem 2

This problem uses the Mr. Trash Wheel data set, available as an Excel file on the course website.

## ii. Import and Clean Mr. Trash Wheel

Read and clean the Mr. Trash Wheel sheet:

* specify the sheet in the Excel file and to omit non-data entries (rows with notes / figures; columns containing notes) using arguments in read_excel
* use reasonable variable names
* omit rows that do not include dumpster-specific data

```{r import and clean trash wheel data}
#import and clean trash wheel data
#view(trash_wheel_mr_df)

trash_wheel_mr_df = read_excel("./p8105_hw2_jwc2177_data/202309 Trash Wheel Collection Data.xlsx", 1) %>% 
  
  janitor::clean_names() %>% 
  
  select(-x15, -x16) %>% 
  
  mutate(month = str_to_lower(month)) %>% 
  
  separate(date, into = c("year2", "month2", "day")) %>% 
  
  select(-year2, -month2) %>% 
  
  relocate(dumpster, year, month, day) %>% 
  
  mutate(year = as.numeric(year)) %>% 
  
  mutate(trash_wheel_name = "trash_wheel_mr") %>% 
  
  relocate(trash_wheel_name)

trash_wheel_df
```


##. iii. New Homes Powered

The data include a column for the (approximate) number of homes powered. This calculation is described in the Homes powered note, but not applied to every row in the dataset. Update the data to include a new homes_powered variable based on this calculation.

```{r new homes powered}
#new homes powered

#note: new homes powered (nhp)

#note: Homes Powered - Each ton of trash equates to on average 500 kilowatts of electricity.  An average household will use 30 kilowatts per day.

#view(trash_wheel_nhp_df)

trash_wheel_nhp_df = trash_wheel_mr_df %>% 
  
  mutate(weight_ton_power = weight_tons*500) %>% 
  
  mutate(homes_powered_2 = weight_ton_power/30) %>% 
  
  select(-homes_powered) %>% 
  
  rename(homes_powered = homes_powered_2) %>% 
  
  mutate(year = as.numeric(year)) %>% 

  mutate(trash_wheel_name = "trash_wheel_nhp_mr") %>% 
  
  relocate(trash_wheel_name)
  
trash_wheel_nhp_df

```

##. iv. Importing, Cleaning, and Organizing Professor Trash Wheel and Gwynnda 

Use a similar process to import, clean, and organize the data for Professor Trash Wheel and Gwynnda, and combine these with the Mr. Trash Wheel dataset to produce a single tidy dataset. To keep track of which Trash Wheel is which, you may need to add an additional variable to all datasets before combining.

###. a. Professor Trash Wheel 
```{r professor trash wheel}
#professor trash wheel
#view(trash_wheel_prof_df)

trash_wheel_prof_df = read_excel("./p8105_hw2_jwc2177_data/202309 Trash Wheel Collection Data.xlsx", 2) %>% 
  
  janitor::clean_names() %>% 
  
  mutate(month = str_to_lower(month)) %>% 
  
  separate(date, into = c("year2", "month2", "day")) %>% 
  
  select(-year2, -month2) %>% 
  
  relocate(dumpster, year, month, day) %>% 
  
  mutate(year = as.numeric(year)) %>% 

  mutate(trash_wheel_name = "trash_wheel_prof") %>% 
  
  relocate(trash_wheel_name)

trash_wheel_prof_df
```

### b. Gwynnda

```{r gwynnda trash wheel}
#gwynnda trash wheel
#view(gwynnda_df)

gwynnda_df  = read_excel("./p8105_hw2_jwc2177_data/202309 Trash Wheel Collection Data.xlsx", 4) %>% 
  
  janitor::clean_names() %>% 
  
  mutate(month = str_to_lower(month)) %>% 
  
  separate(date, into = c("year2", "month2", "day")) %>% 
  
  select(-year2, -month2)%>% 
  
  relocate(dumpster, year, month, day) %>% 
  
  mutate(year = as.numeric(year)) %>% 

  mutate(trash_wheel_name = "trash_wheel_gwynnda") %>% 
  
  relocate(trash_wheel_name)

gwynnda_df
```

### c. Trash Wheel Family

```{r trash wheel family}
#trash wheel family 
#view(mr_prof_df)
#view(trash_wheel_family_df)

mr_prof_df = 
  left_join(trash_wheel_nhp_df, trash_wheel_prof_df)

mr_prof_df

trash_wheel_family_df = 
  left_join(mr_prof_df, gwynnda_df)

trash_wheel_family_df

```


v. Write a paragraph about these data; you are encouraged to use inline R. Be sure to note the number of observations in the resulting dataset, and give examples of key variables. For available data, what was the total weight of trash collected by Professor Trash Wheel? What was the total number of cigarette butts collected by Gwynnda in July of 2021?


#III. Problem 3